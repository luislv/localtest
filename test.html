<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <script type="text/javascript" src="jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="ceshi.js"></script>
</head>
<body>
<script type="text/javascript">

  /*  $(window).bind('beforeunload',function(){
        if (true) {
            alert (333)
        } else {
            return "333";
        }
    });
    */


</script>
<script language="javascript" type="text/javascript">
    var start;
    var end;
    var state;
    start = new Date();//start是用户进入页面时间
    $(document).ready(function() {//用户页面加载完毕，这个是jquery初始化的语句（不知道初始化这个词用的是否正确）
        $(window).unload(function() {//页面卸载，就是用户关闭页面、点击链接跳转到其他页面或者刷新页面都会执行
            end = new Date();//用户退出时间
            state = end.getTime() - start.getTime();//停留时间=退出时间-开始时间（得到的是一个整数，应该是毫秒为单位，1秒=1000）
            $.post("action_to_sql.aspx", { state_time: state, state_url: window.location.pathname ,state_title: $("title").html() });//把值传到action_to_sql.aspx页面写入数据库（一开始我不想这样做，希望在本页面直接处理写入数据库，后来发现我的是生成静态页面的，无法在原来页面完成数据处理，所以学习jquery，并采用这种方法解决，才发现jquery真的是个好东西。）
            alert (333);
         });
    });
</script>
</body>
</html>